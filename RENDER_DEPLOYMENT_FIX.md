# Fix Render Deployment - CORS/Localhost Issue

## Problem
Your deployed app is trying to access `http://localhost:8000` instead of using the deployed API URL.

## Root Cause
The frontend was built with the wrong API URL. It needs to be rebuilt with `VITE_API_URL=/api`.

## Solution

### Option 1: Quick Fix in Render Dashboard (Recommended)

1. **Go to your Render service dashboard**
2. **Navigate to Environment tab**
3. **Add this environment variable:**
   ```
   VITE_API_URL=/api
   ```
4. **Set the following variables (if not already set):**
   ```
   SECRET_KEY=<generate-a-secure-key>
   DEBUG=False
   RENDER_EXTERNAL_HOSTNAME=visionforge-bz3s.onrender.com
   GEMINI_API_KEY=AIzaSyBphxkgfPinCAeXDf0MhKJekgB3pVeLOUE
   ```
5. **Trigger a manual deploy** (or push a commit to trigger rebuild)

### Option 2: Use render.yaml (Blueprint)

If you want to use Render Blueprint:

1. **Commit the new `render.yaml` file:**
   ```bash
   git add project/render.yaml project/build_frontend.sh
   git commit -m "Add Render blueprint and fix API URL"
   git push
   ```

2. **In Render Dashboard:**
   - Delete your current service
   - Click "New +" → "Blueprint"
   - Connect your repository
   - It will automatically use `render.yaml`

3. **Set these secrets in the dashboard** (not in render.yaml):
   - `RENDER_EXTERNAL_HOSTNAME` = `visionforge-bz3s.onrender.com`
   - `GEMINI_API_KEY` = `AIzaSyBphxkgfPinCAeXDf0MhKJekgB3pVeLOUE`

## Required Environment Variables on Render

```env
SECRET_KEY=<auto-generated-or-set-manually>
DEBUG=False
RENDER_EXTERNAL_HOSTNAME=visionforge-bz3s.onrender.com
AI_PROVIDER=gemini
GEMINI_API_KEY=AIzaSyBphxkgfPinCAeXDf0MhKJekgB3pVeLOUE
VITE_API_URL=/api
```

## Build Command for Render
```bash
pip install -r requirements.txt && ./build_frontend.sh && python manage.py collectstatic --no-input
```

## Start Command for Render
```bash
gunicorn backend.wsgi:application
```

## Verification

After redeploying, check:
1. Open browser DevTools → Network tab
2. API calls should go to `/api/...` (relative paths)
3. No more CORS errors
4. No more `localhost:8000` references

## Notes
- The build script now sets `VITE_API_URL=/api` by default
- Single-service deployment = no CORS issues
- All API calls use relative paths on the same domain
